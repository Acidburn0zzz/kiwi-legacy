\chapter{ISO Image---Live Systems}
\index{KIWI images!ISO|(}
\label{chapter:iso}
\minitoc

A live system image is an operating System on CD or DVD. In principal
one can treat the CD/DVD as the hard disk of the system with the
restriction that you can't write data on it. So as soon as the media
is plugged into the computer the machine is able to boot from that
media. After some time one can login to the system and work with it
like on any other system. All write actions takes place in RAM space
and therefore all changes will be lost as soon as the computer shuts
down.

\section{Building the suse-live-iso Example}

The latest example provided with KIWI is based on openSUSE 11.2 and
includes the base and KDE patterns.

\begin{Command}{12cm}
cd /usr/share/doc/packages/kiwi/examples
cd suse-11.2
kiwi --prepare ./suse-live-iso --root /tmp/myiso

kiwi --create /tmp/myiso --type iso -d /tmp/myiso-result
\end{Command}

\section{Using the Image}

There are two ways to use the generated ISO image:
\begin{itemize}
\item Burn the \path{.iso} file on a CD or DVD with your preferred burn program.
      Plug in the CD or DVD into a test computer and (re)boot the machine.
      Make sure the computer boot from the CD drive as first boot device.
\item Use a virtualisation system to test the image directly. Testing an
      iso can be done with any full virtual system for example:

\begin{Command}{12cm}
cd /tmp/myiso-result
qemu -cdrom ./suse-11.2-live-iso.i686-2.5.1.iso -m 256
\end{Command}
\end{itemize}

\section{Flavours}

KIWI supports different filesystems and boot methods along with the
ISO image type. The provided example by default uses a squashfs compressed
root filesystem. By design of this filesystem it is not possible to write
data on it. To be able to write on the filesysetem another filesystem called
aufs is used. aufs is an overlay filesystem which allows to combine two
different filesystems into one. In case of a live system aufs is used
to combine the squashfs compressed read only root tree with a tmpfs
RAM filesystem. The result is a full writable root tree whereas all
written data lives in RAM and is therefore not persistent. squashfs and/or
aufs does not exist on all versions of SUSE and therefore the flags
attribute in config.xml exists to be able to have the following
alternative solutions:

\begin{itemize}
\item \xmlattrval{flags}{unified}\\
      Compressed and unified root tree as explained above
\item \xmlattrval{flags}{compressed}\index{filesystem!compression}\\
      Does filesystem compression with squashfs but don't use an
      overlay filesystem for write support. A symbolic link list is used
      instead and thus a split element is required in \path{config.xml}.
      See the Split mode section below for details.
\item \xmlattrval{flags}{clic}\index{FUSE}\\
      Creates a FUSE based clicfs image and allows write operations
      into a cow file. In case of an ISO the write happens into a
      ramdisk.
\item {Flags Not Set}\\
      If no flags attribute is set no compressed filesystem and no overlay
      filesystem will be used. The root tree will be directly part of
      the ISO filesystem and the paths: \path{/bin}, \path{/boot}, 
      \path{/lib}, \path{/lib64}, \path{/opt},
      \path{/sbin}, and \path{/usr} will be read-only.
\end{itemize}

\subsection{Split mode}

If no overlay filesystem is in use but the image filesystem is based on
a compressed filesystem KIWI allows to setup which files and directories
should be writable in a so called split section. In order to allow to
login into the system at least the \path{/var} directory should be writable
because the PAM authentification requires to be able to report any login
attempt to \path{/var/log/messages} which therefore needs to be writable. The
following split section can be used if the flag compressed
is used:  

\begin{xml}
<split>
   <temporary>
       <file name="/var"/>
       <file name="/var/*"/>
       <file name="/boot"/>
       <file name="/boot/*"/>
       <file name="/etc"/>
       <file name="/etc/*"/>
       <file name="/home"/>
       <file name="/home/*"/>
   </temporary>
</split>
\end{xml}

\index{KIWI images!ISO|)}
