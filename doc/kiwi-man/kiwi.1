.\"     Title: kiwi
.\"    Author: Marcus Schaefer <ms (AT) suse.de>
.\" Generator: DocBook XSL Stylesheets v1.73.2 <http://docbook.sf.net/>
.\"      Date: Created: 09/19/2008
.\"    Manual: KIWI Manualpage
.\"    Source: KIWI v2.10, r938
.\"
.TH "KIWI" "1" "Created: 09/19/2008" "KIWI v2\.10, r938" "KIWI Manualpage"
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.SH "NAME"
kiwi - Creating Operating System Images
.SH "SYNOPSIS"
.HP 5
\fBkiwi\fR {\-l | \-\-list}
.SH "IMAGE PREPARATION AND CREATION"
.PP
KIWI is a complete imaging solution that is based on image description\. Such a description is represented by a directory which includes at least one
\fIconfig\.xml\fR
file and may as well include other files like scripts or configuration data\. Two example descriptions are provided with KIWI in
\fI\%file:///usr/share/doc/packages/kiwi/examples/\fR\. A detailed description of the contents of an image description exists in the system design document in
\fI\%file:///usr/share/doc/packages/kiwi/kiwi.pdf\fR\. KIWI always operates in two steps\. The first step is the preparation step and if that step was successful, a creation step follows which is able to create different image output types\. In the preparation step, you prepare a directory including the contents of your new filesystem based on one or more software package source(s) (such as openSUSE 10\.3)\. The creation step is based on the result of the preparation step and uses the contents of the new image root tree to create the output image\. If the image type ISO was requested, the output image would be a file with the suffix
\fI\.iso\fR
representing a live system on CD or DVD\.
.HP 5
\fBkiwi\fR {\-p | \-\-prepare} \fIImagePath\fR \fIImagePath\fR
.br
[\-r | \-\-root\fIRootPath\fR] [\-\-base\-root\ \fIBasePath\fR] [\-\-base\-root\-mode\ {copy\ |\ union\ |\ recycle}] [\-\-add\-profile\ \fIProfilename\fR]
.HP 5
\fBkiwi\fR {\-c | \-\-create} \fIImageRoot\fR
.br
[\-d | \-\-destdir\fIDestinationPath\fR] [\-\-base\-root\ \fIBasePath\fR] [\-\-base\-root\-mode\ {copy\ |\ union\ |\ recycle}] [\-\-prebuiltbootimage\ \fIDirectory\fR]
.SH "IMAGE UPGRADE"
.PP
If the image root tree is stored and not removed, it can be used for upgrading the image root tree according to the changes made in the repositories used for this image\. If a distributor provides an update channel for package updates and an image
\fIconfig\.xml\fR
includes this update channel as repository, it is useful to store the image root tree and upgrade the tree according to changes on the update channel\.
.HP 5
\fBkiwi\fR {\-u | \-\-upgrade} \fIImageroot\fR [\-\-base\-root\ \fIBasepath\fR]
.SH "SYSTEM TO IMAGE MIGRATION"
.PP
The migration module allows you to migrate your currently running system into an image description\. The module will check for files not managed by a package manager and it will suggest a repository from which this operating system could be rebuild\. The result is quite useful but in most cases a manual fine tuning is required\. This includes the repository selection and the unmanaged files along with the configuration details of your currently running operating system\.
.HP 5
\fBkiwi\fR {\-m | \-\-migrate} \fIname\fR \-\-destdir\ \fIDestinationPath\fR [\-\-exclude\ \fIDirectory\fR...] [\-\-report]
.SH "IMAGE POSTPROCESSING MODES"
.PP
The KIWI post\-processing modes are used for special image deployment tasks, like installing the image on a USB stick\. They are the third step after preparing and creating
and if possible, KIWI calls them automatically depending on the specified output image type and attributes\.
.HP 5
\fBkiwi\fR \-\-bootstick\ \fIInitrd\fR [\-\-bootstick\-system\ \fISystemImage\fR] [\-\-bootstick\-device\ \fIDevice\fR]
.HP 5
\fBkiwi\fR \-\-bootvm\ \fIInitrd\fR \-\-bootvm\-system\ \fISystemImage\fR [\-\-bootvm\-disksize\ \fISize\fR] [\-\-bootvm\-format\ \fIFormat\fR]
.HP 5
\fBkiwi\fR \-\-bootcd\ \fIInitrd\fR
.HP 5
\fBkiwi\fR \-\-installcd\ \fIInitrd\fR \-\-installcd\-system\ \fIVMXSystemImage\fR
.HP 5
\fBkiwi\fR \-\-installstick\ \fIInitrd\fR \-\-installstick\-system\ \fIVMXSystemImage\fR
.SH "HELPER TOOLS"
.PP
The helper tools provide optional functions like creating a crypted password string for the users section of the
\fIconfig\.xml\fR
file or signing the image description with an md5sum hash as well as adding splash data to the boot image used by the bootloader and the testsuite mode which allows testing the integrity of the new root tree\.
.HP 5
\fBkiwi\fR \-\-testsuite\ \fIimage\-root\fR [\-\-test\ \fIname\fR...]
.HP 5
\fBkiwi\fR \-\-createpassword
.HP 5
\fBkiwi\fR \-\-createhash\ \fIimage\-path\fR
.HP 5
\fBkiwi\fR {\-i | \-\-list\-profiles} \fIImagePath\fR
.HP 5
\fBkiwi\fR {\-x | \-\-list\-xmlinfo} \fIImagePath\fR [\-\-type\ \fIImageType\fR]
.HP 5
\fBkiwi\fR \-\-setup\-splash\ \fIinitrd\fR
.SH "OPTIONS"
.PP
KIWI has the following options:
.PP
[\fB\-\-createpassword\fR]
.RS 4
Create a crypted password hash
.RE
.PP
[\fB\-\-createhash \fR\fB\fIimage\-path\fR\fR ]
.RS 4
Sign your image description with a md5sum
.RE
.PP
[\fB\-i\fR | \fB\-\-list\-profiles \fR\fB\fIimage\-path\fR\fR ]
.RS 4
List the profile names of the image description if any
.RE
.PP
[\fB\-x\fR | \fB\-\-list\-xmlinfo \fR\fB\fIimage\-path\fR\fR ]
.RS 4
List general information about the image description
.RE
.PP
[\fB\-\-setup\-splash \fR\fB\fIinitrd\fR\fR ]
.RS 4
Create splash screen from the data inside the initrd and re\-create the initrd with the splash screen attached to the initrd cpio archive\. This enables the kernel to load the splash screen at boot time\. If splashy is used only a link to the original initrd will be created
.RE
.PP
[\fB\-d\fR | \fB\-\-destdir \fR\fB\fIDestinationPath\fR\fR]
.RS 4
Specify destination directory to store the image file(s) If not specified, KIWI will try to find the attribute
\fIdefaultdestination\fR
which can be specified in the
\fIpreferences\fR
section of the
\fIconfig\.xml\fR
file\. If it exists its value is used as destination directory\. If no destination information can be found, an error occurs
.RE
.PP
[\fB\-t\fR | \fB\-\-type \fR\fB\fIImagetype\fR\fR]
.RS 4
Specify the output image type to use for this image\. Each type is described in a
\fItype\fR
section of the preferences section\. At least one type has to be specified in the
\fIconfig\.xml\fR
description\. By default, the types specifying the
\fIprimary\fR
attribute will be used\. If there is no primary attribute set, the first type section of the preferences section is the primary type\. The types are only evaluated when kiwi runs the
\fB\-\-create\fR
step\. With the option
\fB\-\-type\fR
one can distinguish between the types stored in
\fIconfig\.xml\fR
.RE
.PP
[\fB\-r\fR | \fB\-\-root \fR\fB\fIRootPath\fR\fR]
.RS 4
Set up the physical extend, chroot system below the given root\-path path\. If no
\fB\-\-root\fR
option is given, KIWI will search for the attribute defaultroot in
\fIconfig\.xml\fR\. If no root directory is known, a
\fBmktmp\fR
directory will be created and used as root directory
.RE
.PP
[\fB\-\-base\-root\fR \fIBasePath\fR]
.RS 4
Refers to an already prepared root tree\. Kiwi will use this tree to skip the first stage of the prepare step and run the second stage directly\.
.RE
.PP
[\fB\-s\fR | \fB\-\-strip\fR]
.RS 4
Strip shared objects and executables only make sense in combination with
\fB\-\-create\fR
.RE
.PP
[\fB\-\-add\-repo \fR\fB\fIRepoPath\fR\fR, \fB\-\-add\-repotype \fR\fB\fIType\fR\fR ]
.RS 4
Add the given repository and type for this run of an image prepare or upgrade process\. Multiple
\fB\-\-add\-repo\fR/\fB\-\-add\-repotype\fR
options are possible\. The change will not be written to the
\fIconfig\.xml\fR
file
.RE
.PP
[\fB\-\-(add|set)\-repoalias \fR\fB\fIalias name\fR\fR ]
.RS 4
Alias name to be used for this repository\. This is an optional free form text\. If not set the source attribute value is used and builds the alias name by replacing each \'/\' with a \'_\'\. An alias name should be set if the source argument doesn\'t really explain what this repository contains
.RE
.PP
[\fB\-\-(add|set)\-repoprio \fR\fB\fInumber\fR\fR ]
.RS 4
Channel priority assigned to all packages available in this channel (0 if not set)\. If the exact same package is available in more than one channel, the highest priority is used
.RE
.PP
[\fB\-\-ignore\-repos\fR]
.RS 4
Ignore all repositories specified so far, in XML or elsewhere\. This option should be used in conjunction with subsequent calls to
\fB\-\-add\-repo\fR
to specify repositories at the commandline that override previous specifications\.
.RE
.PP
[\fB\-\-set\-repo \fR\fB\fIRepoPath\fR\fR\fB \fR\fB[\fB\-\-set\-repotype \fR\fB\fIType\fR\fR]\fR]
.RS 4
Set the given repository and optional type for the first repository entry within the
\fIconfig\.xml\fR\. The change will not be written to the XML file and is valid for the subsequent image preparation or upgrade process\.
.RE
.PP
[\fB\-\-add\-package\fR \fIpackage\fR ]
.RS 4
Add the given package name to the list of image packages multiple \-\-add\-package options are possible\. The change will not be written to the xml description
.RE
.PP
[\fB\-\-logfile \fR\fB\fIFilename\fR\fR | \fBterminal\fR]
.RS 4
Write to the log file
\fIFilename\fR
instead of the terminal\.
.RE
.PP
[\fB\-\-gzip\-cmd \fR\fB\fIcmd\fR\fR]
.RS 4
Specify an alternate command to run when compressing boot and system images\. Command must accept
\fBgzip\fR
options\.
.RE
.PP
[\fB\-\-force\-new\-root\fR]
.RS 4
Force creation of new root directory\. If the directory already exists, it is deleted\.
.RE
.PP
[\fB\-\-log\-port \fR\fB\fIPortNumber\fR\fR]
.RS 4
Set the log server port\. By default port 9000 is used\. If multiple KIWI processes runs on one system it\'s recommended to set the logging port per process
.RE
.PP
[\fB\-\-prebuiltbootimage \fR\fB\fIDirectory\fR\fR]
.RS 4
Search in
\fIDirectory\fR
for pre\-built boot images\.
.RE
.PP
[\fB\-\-isocheck\fR]
.RS 4
in case of an iso image the checkmedia program generates a md5sum into the iso header\. If the \-\-isocheck option is specified a new boot menu entry will be generated which allows to check this media
.RE
.PP
[\fB\-\-testsuite \fR\fB\fIimage\-root\fR\fR \fB\-\-test \fR\fB\fIname\fR\fR ]
.RS 4
run test(s) on prepared image root tree\. If additional name is omitted default set of tests will be used\. Otherwise only provided tests will be executed
.RE
.PP
[\fB\-\-package\-manager \fR\fB\fIsmart|zypper\fR\fR ]
.RS 4
Set the package manager to use for this image\. If set it will temporarly overwrite the value set in the xml description
.RE
.PP
[\fB\-\-fs\-blocksize \fR\fB\fInumber\fR\fR ]
.RS 4
When calling kiwi in creation mode this option will set the block size in bytes\. For ISO images with the old style ramdisk setup a blocksize of 4096 bytes is required
.RE
.PP
[\fB\-\-fs\-journalsize \fR\fB\fInumber\fR\fR ]
.RS 4
When calling kiwi in creation mode this option will set the journal size in mega bytes for ext[23] based filesystems and in blocks if the reiser filesystem is used
.RE
.PP
[\fB\-\-fs\-inodesize \fR\fB\fInumber\fR\fR ]
.RS 4
When calling kiwi in creation mode this option will set the inode size in bytes\. This option has no effect if the reiser filesystem is used
.RE
.SH "FOR MORE INFORMATION"
.PP
More information about KIWI, its files can be found at:
.PP
\fI\%http://kiwi.berlios.de\fR
.RS 4
Homepage of KIWI
.RE
.PP
\fIconfig\.xml\fR
.RS 4
The configuration XML file that contains every aspect for the image creation\.
.RE
.PP
\fI\%file:///usr/share/doc/packages/kiwi/kiwi.pdf\fR
.RS 4
The system design document which describes some details about the building process\.
.RE
.PP
\fI\%file:///usr/share/kiwi/modules/KIWIScheme.rnc\fR
.RS 4
The KIWI RelaxNG XML Schema file\. This file, and with the help of a XML editor, you can create any
\fIconfig\.xml\fR
file manually\.
.RE
.PP
\fI\%file:///usr/share/kiwi/modules/KIWISchemeTest.rnc\fR
.RS 4
The KIWI RelaxNG XML Schema file\. This file, and with the help of a XML editor, you can create any
\fI(testsuite\-name)\.xml\fR
file manually\.
.RE
.SH "AUTHORS"
.PP
\fBMarcus Schaefer\fR <\&ms (AT) suse\.de\&>
.sp -1n
.IP "" 4
Developer
.PP
\fBThomas Schraitle\fR <\&thomas\.schraitle (AT) suse\.de\&>
.sp -1n
.IP "" 4
Collected information for Manpage

