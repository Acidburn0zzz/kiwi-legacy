#!/bin/bash

version=$1
if ! echo $version | pcregrep -q "^\d+\.\d+$";then
	echo "NOT A VERSION ! ... abort"
	exit 1
fi

# code version update
cat kiwi.pl | sed \
	-e s"@our \$Version       = \".*\"@our \$Version       = \"$version\"@"\
> kiwi.pl.new && mv kiwi.pl.new kiwi.pl

# spec file version update
cat rpm/kiwi.spec | sed \
	-e s"@Version:       .*@Version:       $version@" \
	-e s"@kiwi (Version .*@kiwi (Version $version@" \
> rpm/kiwi.spec.new && mv rpm/kiwi.spec.new rpm/kiwi.spec

echo "update to version: $version... done"
